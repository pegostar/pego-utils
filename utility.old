// <copyright file="Utility.js" company="Siav S.p.A">
// Copyright (c) 2015 All Right Reserved
// </copyright>
// <author>Gianluca Boscolo Bariga</author>
// <email>gianluca.boscolo@siav.it</email>
// <date> 22/09/2015 </date>

/// <summary>
///		Utility class
/// </summary>
///   This class need to be included after jquery, that acts as a strict dependency. Other dependencies (localforage and Promise polyfill for IE) are replaced, if not included,
///   by browser cookies and jquery ajax calls 


/**
 * JsonResult state for ajax calls
 * @type object
 */
var JsonResult = (function (obj) {
	Object.defineProperties(obj, {
		/**
		 * None ajax result code
		 */
		"None": {
			configurable: false,
			value: "NONE"
		},
		/**
		 * Success ajax result code
		 */
		"JsonSuccessResult": {
			configurable: false,
			value: "SUCCESS_JSON_RESULT"
		},
		/**
		 * Generic error ajax result code
		 */
		"GenericError": {
			configurable: false,
			value: "GENERIC_ERROR"
		},
		/**
		 * Permission error ajax result code
		 */
		"PermissionError": {
			configurable: false,
			value: "PERMISSION_ERROR"
		}
		,
		/**
		 * Communication error result code
		 */
		"CommunicationError": {
			configurable: false,
			value: "COMMUNICATION_ERROR"
		},
		/**
		 * Loading error result code
		 */
		"LoadingError": {
			configurable: false,
			value: "LOADING_ERROR"
		},
		/**
	     * Fault error result code
	     */
		"FaultError": {
			configurable: false,
			value: "FAULT_ERROR"
		}
	});
	Object.preventExtensions(obj);
	return obj;
})(new Object());

var MessageType = (function (obj) {
	Object.defineProperties(obj, {
		"ConfirmAndCancel": {
			configurable: false,
			value: 1
		},
		"OnlyConfirm": {
			configurable: false,
			value: 2
		},
		"TwoChoices": {
			configurable: false,
			value: 3
		}
	});
	Object.preventExtensions(obj);
	return obj;
})(new Object());

var ServerErrorCode = (function (obj) {
	Object.defineProperties(obj, {
		"error404": {
			configurable: false,
			value: 404
		},
		"error500": {
			configurable: false,
			value: 500
		},
		"status200": {
			configurable: false,
			value: 200
		}
	});
	return obj;
})(new Object());

/**
 * Ajax response manager. Manage call result
 * @param {} success The success result function
 * @param {} failure The failure result function
 */
var AjaxResponseManager = function (success, failure) {
	var manager = {};
	//success = success || function () { };
	//failure = failure || function () { };
	/**
	 * Function called when ajax end with success state
	 * @param {} result code for response status
	 */
	manager.OnSuccess = function (result) {
		/*
		 * Manage here the result code sent by server
		*/
		switch (result.Code) {
			case JsonResult.JsonSuccessResult:
				if (success != null)
					return success(result.Data);
				else
					return null;
			case JsonResult.PermissionError:
				return Utility.Message.Show(Utility.Resources.Get("Error"), Utility.Resources.Get("PermissionError"));
			case JsonResult.CommunicationError:
				return Utility.Message.Show(Utility.Resources.Get("Error"), Utility.Resources.Get("RequestError"));
			case JsonResult.LoadingError:
				// result case is here managed by loading page
				if (typeof failure === "function") {
					return failure();
				}
				break;
			case JsonResult.GenericError:
				if (typeof failure === "function") {
					failure(ServerErrorCode.status200, JsonResult.GenericError, null);

				}
				var message = null;
				if (result.Data != null && result.Data != String.Empty) {
					message = Utility.Resources.Get("GenericMessageText") + ": " + result.Data;
				}
				return Utility.Message.Error(message);
			case JsonResult.FaultError:
				Utility.Message.Error(result.Data);
				break;
			default:
				return Utility.Message.Error();
		}
	};
	/**
	 * Function called when the ajax call ends with error state
	 * @param {} result the result code sent by server
	 */
	manager.OnFail = function (result) {
		if (result.Status === 0) {
		}
		else if (result.Status === ServerErrorCode.error404) {
		}
		else if (result.Status === ServerErrorCode.error500) {
		}
		else if (result.StatusText === 'parsererror') {
		}
		else if (result.StatusText === 'timeout') {
		}
		else if (result.StatusText === 'abort') {
		}
		else {
			Utility.Console.Warn(result.message);
		}
		if (failure != null) {
			return failure(result.Status, result.StatusText, result.ResponseText);
		}
	};
	Object.preventExtensions(manager);
	return manager;
};

/**
 * Date Formats enum
 */
var DateFormat = (function (obj) {
	Object.defineProperties(obj, {
		"European": {
			configurable: false,
			value: "dd/MM/yyyy"
		},
		"American": {
			configurable: false,
			value: "MM/dd/yyyy"
		},
		"Chinese": {
			configurable: false,
			value: "yyyy/MM/dd"
		}
	});
	Object.preventExtensions(obj);
	return obj;
})(new Object());

/**
 * Log levels enum
 */
var LogLevel = (function (obj) {
	Object.defineProperties(obj, {
		"Info": {
			configurable: false,
			value: "info"
		},
		"Warn": {
			configurable: false,
			value: "warn"
		},
		"Error": {
			configurable: false,
			value: "error"
		},
		"All": {
			configurable: false,
			value: "all"
		}
	});
	Object.preventExtensions(obj);
	return obj;
})(new Object());

/**
 * Utility functions package. Here are defined the following utility sub-sections:
 * * Message
 * * Console
 * * Ajax
 * * Time
 * * File
 * * Json
 * * Loading
 * * LocalForage
 * * Cookie
 * * Resources
 * * Session
 * * Site 
 */
var Utility = (function (Utility) {
	/**
	 * Message utility. It allow to show messages client side. (Note: implements your custom message window in Show method, otherwise it will fallback to standard browser alert)
	 */
	var Message = (function (Message) {
		var messagesQueue = [];

		Object.defineProperties(Message, {
			"Show": {
				configurable: false,
				value: function (title, message, messageType, confirmCallback, secondCallback, okText, ok2Text, cancelCallback) {
					if (message.IsNullOrEmpty()) {
						return;
					}

					// Manage messages queue. If this method is called while another message is shown, this will be opened asap
					if ($("#message-overlay").is(":visible")) {
						messagesQueue.push({
							title: title,
							message: message,
							messageType: messageType,
							confirmCallback: confirmCallback,
							secondCallback: secondCallback,
							okText: okText,
							ok2Text: ok2Text,
							cancelCallback: cancelCallback
						});
						return;
					}

					function close() {
						$(blurredElements).removeClass("blurred");
						$("#message-overlay").hide();
						if (messagesQueue.length > 0) {
							var config = messagesQueue.shift();
							setTimeout(function () {
								Utility.Message.Show(config.title, config.message, config.messageType, config.confirmCallback, config.secondCallback, config.okText, config.ok2Text, config.cancelCallback);
							}, 200);
						}
					}

					messageType = messageType || MessageType.OnlyConfirm;
					okText = okText || Utility.Resources.Get("GenericLabelConfirm");
					ok2Text = ok2Text || String.Empty;

					var okFunction, cancelFunction;
					switch (messageType) {
						case MessageType.OnlyConfirm:
							$("#confirm-modal").html(okText);
							$("#second-confirm-modal, #cancel-modal").hide();
							if (typeof (confirmCallback) != "function") {
								okFunction = close;
							} else {
								okFunction = function () {
									confirmCallback();
									close();
								}
							}
							$("#confirm-modal").unbind("click").bind("click", okFunction);
							break;
						case MessageType.ConfirmAndCancel:
							$("#confirm-modal").html(Utility.Resources.Get("GenericLabelConfirm"));
							$("#second-confirm-modal").hide();
							if (typeof (confirmCallback) != "function") {
								okFunction = close;
							} else {
								okFunction = function () {
									close();
									confirmCallback();
								}
							}
							if (typeof (secondCallback) != "function") {
								cancelFunction = close;
							} else {
								cancelFunction = function () {
									secondCallback();
									close();
								}
							}

							$(blurredElements).addClass("blurred");
							$("#cancel-modal").show().unbind("click").bind("click", cancelFunction);
							break;
						case MessageType.TwoChoices:
							$("#confirm-modal").html(okText);
							$("#second-confirm-modal").html(ok2Text);
							if (typeof (confirmCallback) != "function") {
								okFunction = close;
							} else {
								okFunction = function () {
									confirmCallback();
									close();
								}
							}

							var secondClick;

							if (typeof (secondCallback) != "function") {
								secondClick = close;
							}
							else {
								secondClick = function () {
									secondCallback();
									close();
								}
							}


							if (typeof (cancelCallback) != "function") {
								cancelFunction = close;
							}
							else {
								cancelFunction = function () {
									cancelCallback();
									close();
								}
							}

							$(blurredElements).addClass("blurred");
							$("#second-confirm-modal").show().unbind("click").bind("click", secondClick);
							$("#cancel-modal").show().unbind("click").bind("click", cancelFunction);
							break;
					}

					$("#confirm-modal").unbind("click").bind("click", okFunction);

					$("#message-overlay").show();

					$("#message-window  .message-title, #message-window .message-text").html("");
					title = title || Utility.Resources.Get("GenericMessageTitle");
					$("#message-window  .message-title").html(title);
					$("#message-window .message-text").html(message);
				}
			},
			"ShowBottomWarningToast": {
				configurable: false,
				value: function (message) {
					if (!toastr || typeof (message) !== "string" || message == null || message == String.Empty) {
						return;
					}

					toastr.options.closeButton = true;
					toastr.options.positionClass = "toast-bottom-right";
					toastr.options.showDuration = 300;
					toastr.options.hideDuration = 1000;
					toastr.options.timeOut = 5000;
					toastr.options.extendedTimeOut = 1000;
					toastr.options.showEasing = "swing";
					toastr.options.hideEasing = "linear";
					toastr.options.showMethod = "fadeIn";
					toastr.options.hideMethod = "fadeOut";
					toastr.options.onclick = null;
					toastr.warning(message);
				}
			},
			"ShowBottomInfoToast": {
				configurable: false,
				value: function (message) {
					if (!toastr || typeof (message) !== "string" || message == null || message == String.Empty) {
						return;
					}

					toastr.options.closeButton = true;
					toastr.options.positionClass = "toast-bottom-right";
					toastr.options.showDuration = 300;
					toastr.options.hideDuration = 1000;
					toastr.options.timeOut = 5000;
					toastr.options.extendedTimeOut = 1000;
					toastr.options.showEasing = "swing";
					toastr.options.hideEasing = "linear";
					toastr.options.showMethod = "fadeIn";
					toastr.options.hideMethod = "fadeOut";
					toastr.options.onclick = null;
					
					toastr.info(message);
				}
			},
			"ShowBottomInfoToastPermanent": {
				configurable: false,
				value: function (message, onClick) {
					if (!toastr || typeof (message) !== "string" || message == null || message === String.Empty) {
						return;
					}

					if (onClick != undefined && typeof (onClick) === "function") {
						toastr.options.onclick = onClick;
					} else {
						toastr.options.onclick = null;
					}

					toastr.options.closeButton = true;
					toastr.options.positionClass = "toast-bottom-right";
					toastr.options.showDuration = 300;
					toastr.options.hideDuration = 1000;
					toastr.options.timeOut = 0;
					toastr.options.extendedTimeOut = 0;
					toastr.options.showEasing = "swing";
					toastr.options.hideEasing = "linear";
					toastr.options.showMethod = "fadeIn";
					toastr.options.hideMethod = "fadeOut";

					toastr.info(message);
				}
			},
			"ShowBottomErrorToast": {
				configurable: false,
				value: function (message) {
					if (!toastr || typeof (message) !== "string" || message == null || message == String.Empty) {
						return;
					}

					toastr.options.closeButton = true;
					toastr.options.positionClass = "toast-bottom-right";
					toastr.options.showDuration = 300;
					toastr.options.hideDuration = 1000;
					toastr.options.timeOut = 5000;
					toastr.options.extendedTimeOut = 1000;
					toastr.options.showEasing = "swing";
					toastr.options.hideEasing = "linear";
					toastr.options.showMethod = "fadeIn";
					toastr.options.hideMethod = "fadeOut";
					toastr.options.onclick = null;

					toastr.error(message);
				}
			},
			"ShowBottomSuccessToast": {
				configurable: false,
				value: function (message, timeout) {
					var tTimeout = 5000;

					if (!toastr || typeof (message) !== "string" || message == null || message == String.Empty) {
						return;
					}

					if (timeout != null && timeout !== undefined && typeof (timeout) === "number") {
						tTimeout = timeout;
					}

					toastr.options.closeButton = true;
					toastr.options.positionClass = "toast-bottom-right";
					toastr.options.showDuration = 300;
					toastr.options.hideDuration = 1000;
					toastr.options.timeOut = tTimeout;
					toastr.options.extendedTimeOut = 1000;
					toastr.options.showEasing = "swing";
					toastr.options.hideEasing = "linear";
					toastr.options.showMethod = "fadeIn";
					toastr.options.hideMethod = "fadeOut";
					toastr.options.onclick = null;

					toastr.success(message);
				}
			},
			"ShowBottomSuccessToastPermanent": {
				configurable: false,
				value: function (message, onClick) {
					if (!toastr || typeof (message) !== "string" || message == null || message === String.Empty) {
						return;
					}

					if (onClick != undefined && typeof (onClick) === "function") {
						toastr.options.onclick = onClick;
					} else {
						toastr.options.onclick = null;
					}

					toastr.options.closeButton = true;
					toastr.options.positionClass = "toast-bottom-right";
					toastr.options.showDuration = 300;
					toastr.options.hideDuration = 1000;
					toastr.options.timeOut = 0;
					toastr.options.extendedTimeOut = 0;
					toastr.options.showEasing = "swing";
					toastr.options.hideEasing = "linear";
					toastr.options.showMethod = "fadeIn";
					toastr.options.hideMethod = "fadeOut";

					toastr.success(message);
				}
			},
			"Error": {
				configurable: false,
				value: function (message) {
					Utility.Message.Show(Utility.Resources.Get("GenericMessageTitle"), message || Utility.Resources.Get("RequestError"));
				}
			},
			"BootstrapAlert": {
				configurable: false,
				value: function (alertSelector, fadeoutDelay, fadeoutDuration) {
					$(alertSelector).stop(true, true).show();
					var timeout = setTimeout(function () { $(alertSelector).fadeOut(fadeoutDuration); }, fadeoutDelay);

					$(alertSelector).hover(
		                function () {
		                	clearTimeout(timeout);
		                	$(alertSelector).stop(true, true).show();
		                },
		                function () {
		                	timeout = setTimeout(function () { $(alertSelector).fadeOut(fadeoutDuration); }, fadeoutDelay);
		                }
		            );
				}
			},

		});
		return Message;
	})(new Object());
	Object.defineProperty(Utility, "Message",
	{
		configurable: false,
		value: Message
	});

	var Validators = (function (Validators) {
		Object.defineProperties(Validators,
		{
			"ValidateEmail": {
				configurable: false,
				value: function (email) {
					var re = /^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/;
					return re.test(email);
				}
			},
			"ValidateTaxId": {
				configurable: false,
				value: function (cf) {
					var i, s, set1, set2, setpari, setdisp;
					if (cf == '') return '';
					cf = cf.toUpperCase();
					if (cf.length != 16)
						return false;
					var validi = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";
					for (i = 0; i < 16; i++) {
						if (validi.indexOf(cf.charAt(i)) == -1)
							return false;
					}
					set1 = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ";
					set2 = "ABCDEFGHIJABCDEFGHIJKLMNOPQRSTUVWXYZ";
					setpari = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
					setdisp = "BAKPLCQDREVOSFTGUHMINJWZYX";
					s = 0;
					for (i = 1; i <= 13; i += 2)
						s += setpari.indexOf(set2.charAt(set1.indexOf(cf.charAt(i))));
					for (i = 0; i <= 14; i += 2)
						s += setdisp.indexOf(set2.charAt(set1.indexOf(cf.charAt(i))));
					if (s % 26 != cf.charCodeAt(15) - 'A'.charCodeAt(0))
						return false;
					return true;
				}
			}
		});
		return Validators;
	})(new Object());
	Object.defineProperty(Utility, "Validators", {
		configurable: false,
		value: Validators
	});

	/**
	 * Console utility. It allows to manage the browser console setting a log level, that's Info for Debug or Error for Release in Utility.Site.SiteInit method. 
	 * Please note that you can set a custom log level with Utility.Console.SetConsoleLevel(...)
	 */
	var Console = (function (Console) {
		Object.defineProperties(Console, {
			/**
			 *	Check if the pending log request is admitted by local log level
			 */
			"checkLogLevel": {
				configurable: false,
				value: function (level) {
					switch (this.currentLogLevel || LogLevel.All) {
						case LogLevel.All:
							return true;
						case LogLevel.Error:
							return (level === LogLevel.Error || level === LogLevel.All);
						case LogLevel.Warn:
							return (level === LogLevel.Warn || level === LogLevel.Error || level === LogLevel.All);
						case LogLevel.Info:
							return (level === LogLevel.Warn || level === LogLevel.Error || level === LogLevel.Info || level === LogLevel.All);
					}
					return false;
				}
			},
			/**
			 * Set the local log level
			 */
			"SetConsoleLevel": {
				configurable: false,
				value: function (level) {
					this.currentLogLevel = level;
				}
			},
			/**
			 * Write a console error entry
			 */
			"Error": {
				configurable: false,
				value: function (message) {
					if (this.checkLogLevel(LogLevel.Error)) {
						console.error(message);
					}
				}
			},
			/**
			 *	Write a console warn entry
			 */
			"Warn": {
				configurable: false,
				value: function (message) {
					if (this.checkLogLevel(LogLevel.Warn)) {
						console.warn(message);
					}
				}
			},
			/**
			 * Write a console info entry
			 */
			"Info": {
				configurable: false,
				value: function (message) {
					if (this.checkLogLevel(LogLevel.Info)) {
						console.info(message);
					}
				}
			},
			/**
			 *	Boolean variable for debug configuration, setted by Utility.Site.SiteInit(...) method
			 */
			"IsDebug": {
				value: false
			}
		});
		return Console;
	})(new Object());
	Object.defineProperty(Utility, "Console", {
		configurable: false,
		value: Console
	});

	/**
	 * Ajax call protocols enum
	 */
	var Protocol = (function (Protocol) {
		Object.defineProperties(Protocol, {
			"GET": {
				configurable: false,
				value: "GET"
			},
			"POST": {
				configurable: false,
				value: "POST"
			}
		});
		return Protocol;
	})(new Object());

	/**
	 * Ajax call utility class
	 * 
	 * Example of javascript ajax call:
	 *		var data = { param1: "1", param2: "2" };
	 *		// note that relative paths are filled with site base url
	 *		var params = new AjaxParamethers("Home/TestPost", data);
	 *		return Utility.Ajax.SyncPost(params, function(data){/* ... make something with data returned by server * /}, function(data){/* ...make something in error case * /});
	 *		
	 */
	var Ajax = (function (Ajax) {
		Object.defineProperties(Ajax, {
			/**
			 * Generic function used to make the real ajax call, after every other methods setted their personal settings on params
			 */
			"Call": {
				configurable: false,
				value: function (params, callback, failure) {
					var responseManager;
					if (params == null || params == undefined) {
						throw 'Invalid params parameter';
					}
					/*
					// This code is comment because in date 10/05/2016 receive this wanrning: Invoking 'send()' on a sync XHR during microtask execution is deprecated and will be removed in M53, around September 2016
					// is issued to the old version, if required,
				    if (typeof (Promise) !== "undefined" && typeof ($) !== "undefined" && params.async) {
						responseManager = new AjaxResponseManager(callback, failure);
						var p = new Promise(function (resolve, reject) {
							params.success = resolve;
							params.error = reject;
							$.ajax(params);
						});
						p.then(responseManager.OnSuccess, responseManager.OnFail).catch(this.ErrorHandling);
						
					} else if (typeof ($) !== "undefined") {
					    // fallback to standard jquery ajax call if Promise not supported
					    responseManager = new AjaxResponseManager(callback, failure);

					    params.success = responseManager.OnSuccess;
					    params.error = responseManager.OnFail;
						$.ajax(params);
					}
					else {
						Utility.Console.Error("Cannot make ajax request. Jquery or Promise modules are unavailable");
					}
					*/
					if (typeof ($) !== "undefined") {
						responseManager = new AjaxResponseManager(callback, failure);
						try {
							params.success = responseManager.OnSuccess;
							params.error = responseManager.OnFail;
							$.ajax(params);
						} catch (error) {
							this.ErrorHandling(error);
						}
					} else {
						Utility.Console.Error("Cannot make ajax request. Jquery modules are unavailable");
					}
				}
			},
			/**
			 * Method for async post call
			 */
			"AsyncPost": {
				configurable: false,
				value: function (params, callback, failure) {
					params.method = Protocol.POST;
					params.traditional = false;
					params.dataType = "json",
					this.Call(params, callback, failure);
				}
			},
			/**
			 *	Method for async get call
			 */
			"AsyncGet": {
				configurable: false,
				value: function (params, callback, failure) {
					params.method = Protocol.GET;
					this.Call(params, callback, failure);
				}
			},
			/**
			 * Method for sync post call
			 */
			"SyncPost": {
				configurable: false,
				value: function (params, callback, failure) {
					params.async = false;
					params.method = Protocol.POST;
					params.traditional = false;
					params.dataType = "json",
					this.Call(params, callback, failure);
				}
			},
			/**
			 * method for sync get call
			 */
			"SyncGet": {
				configurable: false,
				value: function (params, callback, failure) {
					params.async = false;
					params.method = Protocol.GET;
					this.Call(params, callback, failure);
				}
			},
			/**
			 * method for sync post cors call
			 */
			"SyncPostCors": {
				configurable: false,
				value: function (params, callback, failure) {
					params.crossDomain = true;
					params.method = Protocol.POST;
					params.traditional = false;
					params.dataType = "json";
					params.async = false;
					this.Call(params, callback, failure);
				}
			},
			/**
			 * method for sync get cors call
			 */
			"SyncGetCors": {
				configurable: false,
				value: function (params, callback, failure) {
					params.crossDomain = true;
					params.method = Protocol.GET;
					params.async = false;
					this.Call(params, callback, failure);
				}
			},
			/**
			 * method for async post cors call
			 */
			"AsyncPostCors": {
				configurable: false,
				value: function (params, callback, failure) {
					params.crossDomain = true;
					params.method = Protocol.POST;
					params.traditional = false;
					this.Call(params, callback, failure);
				}
			},
			/**
			 * method for async get cors call
			 */
			"AsyncGetCors": {
				configurable: false,
				value: function (params, callback, failure) {
					params.crossDomain = true;
					params.method = Protocol.GET;
					this.Call(params, callback, failure);
				}
			},
			/**
			 * Method for error handling
			 */
			"ErrorHandling": {
				configurable: false,
				value: function (error) {
					Utility.Message.Show(Utility.Resources.Get("Error"), Utility.Resources.Get("RequestError"));
					throw (error);
				}
			}
		});
		return Ajax;
	})(new Object());
	Object.defineProperty(Utility, "Ajax", {
		configurable: false,
		value: Ajax
	});

	/**
	 * Perform main operation to client plugin
	 */
	var Plugin = (function (Plugin) {
		Object.defineProperties(Plugin, {
			/**
			 * Remove all operation in async mode
			 */ 
			'AsyncClear': {
				configurable: false,
				value: function (urlserverplugin, failure) {
					if (urlserverplugin == null || urlserverplugin === undefined) {
						urlserverplugin ='http://localhost/archiflowclientplugin';
					}

					$.ajax({
						type: 'GET',
						async: true,
						cache: false,
						url: urlserverplugin + '/api/cancel',
						crossDomain: true,
						success: function (result) {},
						error: function (jqXHR, textStatus, errorThrown) {
							if(failure !== undefined && failure != null)
								failure(jqXHR, textStatus, errorThrown);
						}
					});
				}
			},
			/**
			 * Remove all operation in sync mode
			 */ 
			'SyncClear': {
				configurable: false,
				value: function (urlserverplugin, failure) {
					if (urlserverplugin == null || urlserverplugin === undefined) {
						urlserverplugin ='http://localhost/archiflowclientplugin';
					}

					$.ajax({
						type: 'GET',
						async: false,
						cache: false,
						url: urlserverplugin + '/api/cancel',
						crossDomain: true,
						success: function (result) {},
						error: function (jqXHR, textStatus, errorThrown) {
							if(failure !== undefined && failure != null)
								failure(jqXHR, textStatus, errorThrown);
						}
					});
				}
			},
			/**
			 * Get information about client in async mode
			 */ 
			'AsyncVersion': {
				configurable: false,
				value: function (version, urlupdate, urlserverplugin, callback, failure) {
					if (version === undefined || version === null || version.length === 0 || version.split('.').length !== 4) {
						throw 'Invalid version format';
					}
					if (urlupdate === undefined || urlupdate === null || urlupdate.length === 0) {
						throw 'Invalid urlupdate format';
					}
					if (urlserverplugin == null || urlserverplugin === undefined) {
						urlserverplugin ='http://localhost/archiflowclientplugin';
					}

					var data = {};
					data.Version = version;
					data.UrlUpdate = urlupdate;

					var content = JSON.stringify(data);

					$.ajax({
						type: 'POST',
						async: true,
						cache: false,
						url: urlserverplugin + '/api/diagnostic',
						data: content,
						crossDomain: true,
						success: function (result) {
							if (callback !== undefined && callback != null)
								callback(result);
						},
						error: function (jqXHR, textStatus, errorThrown) {
							if(failure !== undefined && failure != null)
								failure(jqXHR, textStatus, errorThrown);
						}
					});
				}
			},
			/**
			 * Get information about client in sync mode
			 */
			'SyncVersion': {
				configurable: false,
				value: function (version, urlupdate, urlserverplugin, callback, failure) {
					if (version === undefined || version === null || version.length === 0 || version.split('.').length !== 4) {
						throw 'Invalid version format';
					}
					if (urlupdate === undefined || urlupdate === null || urlupdate.length === 0) {
						throw 'Invalid urlupdate format';
					}
					if (urlserverplugin == null || urlserverplugin === undefined) {
						urlserverplugin ='http://localhost/archiflowclientplugin';
					}
					var data = {};
					data.Version = version;
					data.UrlUpdate = urlupdate;

					var content = JSON.stringify(data);

					$.ajax({
						type: 'POST',
						async: false,
						cache: false,
						url: urlserverplugin + '/api/diagnostic',
						data: content,
						crossDomain: true,
						success: function (result) {
							if (callback !== undefined && callback != null)
								callback(result);
						},
						error: function (jqXHR, textStatus, errorThrown) {
							if (failure !== undefined && failure != null)
								failure(jqXHR, textStatus, errorThrown);
						}
					});
				}
			},
			/**
			 * Perform operation signed in async mode
			 */
			'AsyncSign': {
				configurable: false,
				value: function (data, urlserverplugin, callback, failure) {
					if (data === null || data === undefined) {
						throw 'Object data for signed invalid';
					}
					else
					{
						if (data.Url === null || data.Url === undefined || data.Url.length === 0) {
							throw 'Property Url is invalid';
						}
						if (data.GuidConnect === null || data.GuidConnect === undefined || data.GuidConnect.length === 0) {
							throw 'Property GuidConnect is invalid';
						}
						if (data.ListGuidCard === null || data.ListGuidCard === undefined || data.ListGuidCard.length === 0) {
							throw 'Property GuidConnect is invalid';
						}
						if (data.TypeSign === null || data.TypeSign === undefined || data.TypeSign <= 0) {
							data.TypeSign = 1;
						}
					}

					var content = JSON.stringify(data);

					if (urlserverplugin == null || urlserverplugin === undefined) {
						urlserverplugin ='http://localhost/archiflowclientplugin';
					}

					$.ajax({
						type: 'POST',
						traditional: true,
						async: true,
						cache: false,
						url: urlserverplugin + '/api/signed',
						data: content,
						crossDomain: true,
						success: function (result) {
							if (callback !== undefined && callback != null)
								callback(result);
						},
						error: function (jqXHR, textStatus, errorThrown) {
							if (failure !== undefined && failure != null)
								failure(jqXHR, textStatus, errorThrown);
						}
					});
				}
			},
			/**
			 * Perform operation signed in sync mode
			 */
			'SyncSign': {
				configurable: false,
				value: function (data, urlserverplugin, callback, failure) {
					if (data === null || data === undefined) {
						throw 'Object data for signed invalid';
					}
					else
					{
						if (data.Url === null || data.Url === undefined || data.Url.length === 0) {
							throw 'Property Url is invalid';
						}
						if (data.GuidConnect === null || data.GuidConnect === undefined || data.GuidConnect.length === 0) {
							throw 'Property GuidConnect is invalid';
						}
						if (data.ListGuidCard === null || data.ListGuidCard === undefined || data.ListGuidCard.length === 0) {
							throw 'Property ListGuidCard is invalid';
						}
						else
						{
							var isvalid = true;
							for(var i=0; i<data.ListGuidCard.length; i++)
							{
	          					if (data.ListGuidCard[i] === null || data.ListGuidCard[i] === undefined || data.ListGuidCard[i].length === 0)
								{
	          						isvalid = false;
									break;
								}
							}

							if (!isvalid) {
								throw 'Property ListGuidCard is invalid';
							}
						}
						if (data.TypeSign === null || data.TypeSign === undefined || data.TypeSign <= 0) {
							data.TypeSign = 1;
						}
					}

					var content = JSON.stringify(data);

					if (urlserverplugin == null || urlserverplugin === undefined) {
						urlserverplugin ='http://localhost/archiflowclientplugin';
					}

					$.ajax({
						type: 'POST',
						traditional: true,
						async: false,
						cache: false,
						url: urlserverplugin + '/api/signed',
						data: content,
						timeout: 3000000,
						crossDomain: true,
						success: function (result) {
							
							if (callback !== undefined && callback != null)
								callback(result);
						},
						error: function (jqXHR, textStatus, errorThrown) {
							
							if (failure !== undefined && failure != null)
								failure(jqXHR, textStatus, errorThrown);
						}
					});
				}
			}
		});
		return Plugin;

})(new Object());
	Object.defineProperty(Utility, "Plugin", {
		configurable: false,
		value: Plugin
	});

	/**
	*	Time utility class
	*/
	var Time = (function (Time) {
		Object.defineProperties(Time, {
			"ParseStringToDateTime": {
				configurable: false,
				value: function (date) {
					var dateFormat;
					var day;
					var month;
					var year;
					if (/(0[1-9]|1[012])[- /.](0[1-9]|[12][0-9]|3[01])[- /.](19|20)\d\d/.test(date)) {
						dateFormat = DateFormat.American;
					}
					else if (/(19|20)\d\d[- /.](0[1-9]|1[012])[- /.](0[1-9]|[12][0-9]|3[01])/.test(date)) {
						dateFormat = DateFormat.Chinese;
					}
					else {
						dateFormat = DateFormat.European;
					}
					try {
						var dayIndex, monthIndex, yearIndex;
						switch (dateFormat) {
							case DateFormat.American:
								dayIndex = 1;
								monthIndex = 0;
								yearIndex = 2;
								break;
							case DateFormat.Chinese:
								yearIndex = 0;
								monthIndex = 1;
								dayIndex = 2;
								break;
							default:
							case DateFormat.European:
								dayIndex = 0;
								monthIndex = 1;
								yearIndex = 2;
								break;
						}
						date = date.replace(/-/g, "/").replace(/\./g, "/");
						var splitValue = date.split("/");
						if (splitValue[dayIndex].IsNullOrEmpty() ||
							splitValue[monthIndex].IsNullOrEmpty() ||
							splitValue[yearIndex].IsNullOrEmpty()) {
							return null;
						}
						if (splitValue[monthIndex].length < 1 || splitValue[monthIndex].length > 2) {
							return null;
						}
						if (splitValue[yearIndex].length !== 4) {
							return null;
						}
						day = parseInt(splitValue[dayIndex]);
						month = parseInt(splitValue[monthIndex]);
						year = parseInt(splitValue[yearIndex]);
						if (year < 1900) {
							return null;
						}
						if (month < 0 || month > 12 || day < 1 || day > 31) {
							return null;
						}
						var leapYear = (((year % 4) === 0) && ((year % 100) !== 0) || ((year % 400) === 0));
						if (day < 0)
							return null;
						if (month === 2) {
							var valid = leapYear ? day <= 29 : day <= 28;
							if (!valid)
								return null;
						}
						else {
							switch (month) {
								case 4:
								case 6:
								case 9:
								case 11:
									if (day > 30)
										return null;
								default:
									if (day > 31)
										return null;
							}
						}
					}
					catch (e) {
						return null;
					}
					return new Date(year, month - 1, day);
				}
			},
			/**
			 * Parse a datetime into a string object
			 */
			"ParseDateTimeToString": {
				configurable: false,
				value: function (dateTime) {
					var ms = dateTime.getMilliseconds();
					if (ms.toString() === "NaN")
						return null;
					var date = Utility.Time.ConvertMsToString(dateTime.getMilliseconds(), true);
					return date;
				}
			},
			/**
			 * Parse a milliseconds number into a string date
			 */
			"ConvertMsToString": {
				configurable: false,
				value: function (milliseconds, shortFormat) {
					var date = new Date(milliseconds);
					var day;
					switch (date.getDay()) {
						case 0:
							day = Utility.Resources.Get("WeekdaySunday");
							break;
						case 1:
							day = Utility.Resources.Get("WeekdayMonday");
							break;
						case 2:
							day = Utility.Resources.Get("WeekdayTuesday");
							break;
						case 3:
							day = Utility.Resources.Get("WeekdayWednesday");
							break;
						case 4:
							day = Utility.Resources.Get("WeekdayThursday");
							break;
						case 5:
							day = Utility.Resources.Get("WeekdayFriday");
							break;
						case 6:
							day = Utility.Resources.Get("WeekdaySaturday");
							break;
					}
					var month;
					switch (date.getMonth()) {
						case 0:
							month = Utility.Resources.Get("MonthJanuary");
							break;
						case 1:
							month = Utility.Resources.Get("MonthFebruary");
							break;
						case 2:
							month = Utility.Resources.Get("MonthMarch");
							break;
						case 3:
							month = Utility.Resources.Get("MonthApril");
							break;
						case 4:
							month = Utility.Resources.Get("MonthMay");
							break;
						case 5:
							month = Utility.Resources.Get("MonthJune");
							break;
						case 6:
							month = Utility.Resources.Get("MonthJuly");
							break;
						case 7:
							month = Utility.Resources.Get("MonthAugust");
							break;
						case 8:
							month = Utility.Resources.Get("MonthSeptember");
							break;
						case 9:
							month = Utility.Resources.Get("MonthOctober");
							break;
						case 10:
							month = Utility.Resources.Get("MonthNovember");
							break;
						case 11:
							month = Utility.Resources.Get("MonthDecember");
							break;
					}
					var year = date.getFullYear();
					var time = date.toTimeString();
					var data = date.getDate();
					time = time.substr(0, 5);
					if (shortFormat) {
						return data + " " + month + " " + year + " " + time;
					} else {
						return day + ", " + data + " " + month + " " + year + " " + time;
					}
				}
			},
			/**
			 *	Check if a string represents a valid date 
			 */
			"IsValidDate": {
				configurable: false,
				value: function (date, dateFormat) {
					if (!date)
						return false;
					if (dateFormat == null) {
						if (/(0[1-9]|1[012])[- /.](0[1-9]|[12][0-9]|3[01])[- /.](19|20)\d\d/.test(date)) {
							dateFormat = DateFormat.American;
						} else if (/(19|20)\d\d[- /.](0[1-9]|1[012])[- /.](0[1-9]|[12][0-9]|3[01])/.test(date)) {
							dateFormat = DateFormat.Chinese;
						} else {
							dateFormat = DateFormat.European;
						}
					}
					try {
						var dayIndex, monthIndex, yearIndex;
						switch (dateFormat) {
							case DateFormat.American:
								dayIndex = 1;
								monthIndex = 0;
								yearIndex = 2;
								break;
							case DateFormat.Chinese:
								yearIndex = 0;
								monthIndex = 1;
								dayIndex = 2;
								break;
							default:
							case DateFormat.European:
								dayIndex = 0;
								monthIndex = 1;
								yearIndex = 2;
								break;
						}
						date = date.replace(/-/g, '/').replace(/\./g, '/');
						var splitValue = date.split('/');
						if (splitValue[dayIndex].IsNullOrEmpty() ||
							splitValue[monthIndex].IsNullOrEmpty() ||
							splitValue[yearIndex].IsNullOrEmpty()) {
							return false;
						}
						if (splitValue[monthIndex].length < 1 || splitValue[monthIndex].length > 2) {
							return false;
						}
						if (splitValue[yearIndex].length !== 4) {
							return false;
						}
						var day = parseInt(splitValue[dayIndex]);
						var month = parseInt(splitValue[monthIndex]);
						var year = parseInt(splitValue[yearIndex]);
						if (year < 1900) {
							return false;
						}
						if (month < 0 || month > 12 || day < 1 || day > 31) {
							return false;
						}
						var leapYear = (((year % 4) === 0) && ((year % 100) !== 0) || ((year % 400) === 0));
						if (day < 0)
							return false;
						if (month === 2) {
							return leapYear ? day <= 29 : day <= 28;
						} else {
							switch (month) {
								case 4:
								case 6:
								case 9:
								case 11:
									return day <= 30;
								default:
									return day <= 31;
							}
						}
					} catch (e) {
						return false;
					}
				}
			}
		});
		return Time;
	})(new Object());
	Object.defineProperty(Utility, "Time", {
		value: Time,
		configurable: false
	});

	/**
	 * File utility class
	 */
	var File = (function (File) {
		Object.defineProperties(File, {
			"NormalizeByte": {
				configurable: false,
				value: function (byte) {
					var dim = 1;
					var ext = ' B';

					if (byte > Math.pow(2, 20)) {
						dim = Math.pow(2, 20);
						ext = ' MB';
					} else if (byte > Math.pow(2, 10)) {
						dim = Math.pow(2, 10);
						ext = ' KB';
					}

					return (byte / dim).toFixed(2) + ext;
				}
			},
			/**
             * Given a file name, return the extension
             */
			"GetExtension": {
				configurable: false,
				value: function (filename) {
					return /.+\.([a-zA-Z]{2,6})$/.test(filename) ? (RegExp.$1).toLowerCase() : "undefined";
				}
			},
			/**
			 * Given a file name, return the css extension class (useful for file icons)
			 */
			"GetExtensionClassfunction": {
				configurable: false,
				value: function (filename) {
					switch (Utility.File.GetExtension(filename)) {
						case '.jpg':
						case '.img':
						case '.png':
						case '.gif':
						case '.bmp':
						case 'jpg':
						case 'img':
						case 'png':
						case 'gif':
						case 'bmp':
							return "image-file-icon";
						case '.doc':
						case '.docx':
						case 'doc':
						case 'docx':
							return "word-file-icon";
						case '.xls':
						case '.xlsx':
						case 'xls':
						case 'xlsx':
							return "excel-file-icon";
						case 'pdf':
						case '.pdf':
							return "pdf-file-icon";
						case '.zip':
						case '.rar':
						case 'zip':
						case 'rar':
							return "zip-file-icon";
						case '.txt':
						case 'txt':
							return "text-file-icon";
						case '.ppt':
						case '.pptx':
						case '.pptm':
						case '.potx':
						case '.pot':
						case '.ppsm':
						case '.ppsx':
						case '.pps':
						case 'ppt':
						case 'pptx':
						case 'pptm':
						case 'potx':
						case 'pot':
						case 'ppsm':
						case 'ppsx':
						case 'pps':
							return "powerpoint-file-icon";
						case '.rft':
						case 'rtf':
							return "rtf-file-icon";
						case '.eml':
						case 'eml':
						case '.msg':
						case 'msg':
							return "email-file-icon";
						case '.mp3':
						case '.wav':
						case '.aiff':
						case '.flac':
						case '.m4a':
						case '.wma':
						case 'mp3':
						case 'wav':
						case 'aiff':
						case 'flac':
						case 'm4a':
						case 'wma':
							return "sound-file-icon";
						case '.mov':
						case '.mp4':
						case '.ogg':
						case '.avi':
						case '.m4v':
						case '.mpg':
						case '.wmv':
						case '.3gp':
						case 'mov':
						case 'mp4':
						case 'ogg':
						case 'avi':
						case 'm4v':
						case 'mpg':
						case 'wmv':
						case '3gp':
							return "video-file-icon";
						default:
							return "default-file-icon";
					}
				}
			}
		});
		return File;
	})(new Object());
	Object.defineProperty(Utility, "File", {
		value: File,
		configurable: false
	});

	/**
	*	Json utility class
	*/
	var Json = (function (Json) {
		Object.defineProperties(Json, {
			/**
			 * Return a clone of the json input object
			 */
			"Clone": {
				configurable: false,
				value: function (ojson) {
					var clone = {};
					$.map(ojson, function (val, i) {
						if (i[0] === "_") {
							i = i[1].toUpperCase() + i.substring(2);
						}
						clone[i] = val != null && typeof (val) == "object" ? Utility.Json.Clone(val) : val;
					});
					return clone;
				}
			},
			/**
			 * Check if two object have all field values with identical entries
			 */
			"HasAllFieldsValuesOf": {
				configurable: false,
				value: function (ojson1, ojson2) {
					var hasValue = true;
					$.each(ojson2, function (field, value) {
						if (hasValue && ojson1[field] !== value) {
							hasValue = false;
						}
					});
					return hasValue;
				}
			},
			/**
			 *	Check if one object has almost one value identical to one of another json object
			 */
			"HasOneFieldValueOf": {
				configurable: false,
				value: function (ojson1, ojson2) {
					var hasValue = false;
					$.each(ojson2, function (field, value) {
						if (!hasValue && ojson1[field] === value) {
							hasValue = true;
						}
					});
					return hasValue;
				}
			},
			/**
			 *	Get a json object from a xml string
			 */
			"GetFromXml": {
				configurable: false,
				value: function (xml) {
					var result = {};
					var jXml = $(xml);
					var getInnerObjects = function (obj) {
						var jObj = $(obj);
						var resultObj = {};
						var childrens = jObj.children();
						var length, j;
						if (childrens.length > 0) {
							length = childrens.length;
							for (j = 0; j < length; j++) {
								var child = childrens[j];
								resultObj[child.tagName.toLowerCase()] = getInnerObjects(child);
							}
						}
						length = obj.attributes.length;
						for (j = 0; j < length; j++) {
							var attr = obj.attributes[j];
							var nodeValue = attr.nodeValue;
							if (Number(nodeValue) >= 0 || Number(nodeValue) < 0) {
								resultObj[attr.nodeName] = Number(nodeValue);
							}
							else if (nodeValue.toLowerCase() === "true" || nodeValue.toLowerCase() === "false") {
								resultObj[attr.nodeName] = nodeValue.toLowerCase() === "true";
							}
							else if (Utility.Time.IsValidDate(nodeValue)) {
								resultObj[attr.nodeName] = Utility.Time.ParseData(nodeValue);
							}
							else if (Guid.IsValidGuid(nodeValue)) {
								resultObj[attr.nodeName] = new Guid(nodeValue);
							}
							else
								resultObj[attr.nodeName] = attr.nodeValue;
						}

						return resultObj;
					};
					var length = jXml.length;
					for (var j = 0; j < length; j++) {
						var jObj = jXml[j];
						result[jObj.tagName.toLowerCase()] = getInnerObjects(jObj);
					}
					return result;
				}
			},
			/**
			 *	Get dom object from json object
			 */
			"GetHtmlFromJson": {
				configurable: false,
				value: function (obj) {
					var jObj = document.createElement(obj.TagName);
					var j;
					if (obj.Classes != null) {
						var classes = obj.Classes.split(" ");
						for (j = 0; j < classes.length; j++) {
							jObj.classList.add(classes[j]);
						}
					}
					if (obj.CustomTags != null) {
						var tags = obj.CustomTags.split(";");
						if (tags.length > 0) {
							for (j = 0; j < tags.length; j++) {
								var split = tags[j].split(":");
								if (split.length === 2) {
									jObj.setAttribute(split[0], split[1]);
								}
							}
						}
					}
					if (obj.Events && obj.Events.length > 0) {
						for (j = 0; j < obj.Events.length; j++) {
						}
					}
					if (obj.InnerText != null) {
						jObj.innerHTML(obj.InnerText);
					}
					if (obj.Childs != null && obj.Childs.length > 0) {
						for (j = 0; j < obj.Childs.length; j++)
							jObj.appendChild(Utility.Json.GetJHtmlFromJson(obj.Childs[j]));
					}
					return jObj;
				}
			},
			/**
			 * Validate a json object given a rules array
			 */
			"Validate": {
				configurable: false,
				value: function (object, validatorRules) {
					var validationReturn = new Array();
					var validator = new Validator(validatorRules);
					validator.Rules.forEach(function (rule) {
						if (validator.StopAtFirstError && validationReturn.length > 0) {
							return null;
						}
						var report = new ReportMessage(rule.FieldName);
						if (rule.FieldName.IsNullOrEmpty()) {
							report.Message = "EmptyField";
							validationReturn.push(report);
							return null;
						}
						report.FieldName = rule.FieldName;
						var objPath = rule.FieldName.split(".");
						var fieldValue;
						for (var j = 0; j < objPath.length; j++) {
							if (object != null && object[objPath[j]] != null) {
								fieldValue = object[objPath[j]];
							}
							else {
								report.Message = Utility.Resources.Get("NotDefinedValue");
								return validationReturn.push(report);
							}
						}
						switch (rule.Rule) {
							case Rules.NotNull:
								if (fieldValue == null) {
									report.Message = Utility.Resources.Get("NullValue");
									validationReturn.push(report);
								}
								break;
							case Rules.GreaterOrEqualThan:
								if (fieldValue < rule.RefValue) {
									report.Message = Utility.Resources.Get("NotGreaterOrEqualThan");
									validationReturn.push(report);
								}
								break;
							case Rules.GreaterThan:
								if (fieldValue <= rule.RefValue) {
									report.Message = Utility.Resources.Get("NotGreaterThan");
									validationReturn.push(report);
								}
								break;
							case Rules.LessOrEqualThan:
								if (fieldValue > rule.RefValue) {
									report.Message = Utility.Resources.Get("NotLessOrEqualThan");
									validationReturn.push(report);
								}
								break;
							case Rules.LessThan:
								if (fieldValue >= rule.RefValue) {
									report.Message = Utility.Resources.Get("NotLessThan");
									validationReturn.push(report);
								}
								break;
						}
						report = new ReportMessage(rule.FieldName);
						report.FieldName = rule.FieldName;
						switch (rule.Type) {
							case Types.String:
								if (typeof (fieldValue) != "string") {
									report.Message = Utility.Resources.Get("NotValidString");
									validationReturn.push(report);
								}
								break;
							case Types.Number:
								if (!(Number(fieldValue) > 0 || Number(fieldValue) >= 0)) {
									report.Message = Utility.Resources.Get("NotValidNumber");
									validationReturn.push(report);
								}
								break;
							case Types.Date:
								if (!Utility.Time.IsValidDate(fieldValue)) {
									report.Message = Utility.Resources.Get("NotValidDate");
									validationReturn.push(report);
								}
								break;
							case Types.Guid:
								if (!Guid.IsValidGuid(fieldValue)) {
									report.Message = Utility.Resources.Get("NotValidGuid");
									validationReturn.push(report);
								}
								break;
							case Types.Boolean:
								if (fieldValue.ToString().toLowerCase() !== "true" && fieldValue.ToString().toLowerCase() !== "false") {
									report.Message = Utility.Resources.Get("NotValidBoolean");
									validationReturn.push(report);
								}
								break;
						}
						report = new ReportMessage(rule.FieldName);
						if (rule.Pattern != null) {
							if (!rule.Pattern.test(fieldValue)) {
								report.Message = Utility.Resources.Get("NotValidFormat");
								validationReturn.push(report);
							}
						}
						return null;
					});
					if (validationReturn.length > 0) {
						return validationReturn;
					}
					else {
						return null;
					}
				}
			},
			/**
			 * Stringify a json object
			 */
			"Stringify": {
				configurable: false,
				value: function (object) {
					var copy = Utility.Json.Clone(object);
					var result = JSON.stringify(copy, function (key, value) {
						for (var x in value) {
							if (value.hasOwnProperty(x)) {
								if (x[0] === "_") {
									value[x.substring(1)] = value[x];
									value[x] = undefined;
								}
							}
						}
						return value;
					});
					return result;
				}
			}
		});

		return Json;
	})(new Object());
	Object.defineProperty(Utility, "Json", {
		value: Json,
		configurable: false
	});

	/**
	*	Loading utility class
	*/
	var Loading = (function (Loading) {
		Object.defineProperties(Loading, {
			/**
             * Show a waiting dialog overlay. (Note: you must define the loading and loadingImage css classes)
             */
			"ShowWaiting": {
				configurable: false,
				value: function (message) {
					if (document.getElementById("loading-container") != null) {
						return $("#loading-label").html(message);
					}
					var container = document.createElement("div");
					container.id = "loading-container";
					container.classList.add("loading-overlay");
					if (typeof message == "string") {
						var el = document.createElement("div");
						el.id = "loading-label";
						el.innerText = message;
						el.innerHTML = message;
						container.appendChild(el);
					}
					container.appendChild($('<div class="spinner"></div>')[0]);
					document.body.appendChild(container);
					if (!message) {
						$(container).find(".spinner").css("top", "35%");
					}
					$("#loading-container").show();
					$(blurredElements).addClass("blurred");

				}
			},

			"ShowUnManagedWaiting": {
				configurable: false,
				value: function (id) {
					var container = document.createElement("div");
					container.id = id;
					container.classList.add("background-overlay");
					document.body.appendChild(container);
					$("#" + id).css("z-index", "99");
					$("#" + id).show();
					$(blurredElements).addClass("blurred");
				}
			},
			"HideUnManagedWaiting": {
				configurable: false,
				value: function (id) {
					$("#" + id).remove();
					$(blurredElements).removeClass("blurred");
				}
			},

			/**
             *	Hide the waiting dialog overlay
             */
			"HideWaiting": {
				configurable: false,
				value: function () {
					if (document.getElementById("loading-container") != null) {
						$("#loading-container").remove();
						$(blurredElements).removeClass("blurred");

					}
				}
			},
			"ShowBlur": {
				configurable: false,
				value: function () {
					$(blurredElements).addClass("blurred");
				}
			},
			"HideBlur": {
				configurable: false,
				value: function () {
					$(blurredElements).removeClass("blurred");
				}
			}
		});
		return Loading;
	})(new Object());
	Object.defineProperty(Utility, "Loading", {
		value: Loading,
		configurable: false
	});

	/**
	 * Cookie utility class
	 */
	var Cookie = (function (Cookie) {
		Object.defineProperties(Cookie, {
			/**
			 * Set a cookie
			 */
			"Set": {
				configurable: false,
				value: function (cname, cvalue, exdays) {
					exdays = exdays || 365;
					var d = new Date();
					d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));
					var expires = "expires=" + d.toUTCString();
					var domain = "path=/";
					document.cookie = cname + "=" + cvalue + "; " + expires + "; " + domain;
				}
			},
			/**
			 * Get a cookie value if it exist or return empty string otherwise
			 */
			"Get": {
				configurable: false,
				value: function (cname) {
					var name = cname + "=";
					var ca = document.cookie.split(';');
					for (var i = 0; i < ca.length; i++) {
						var c = ca[i];
						while (c.charAt(0) === ' ') c = c.substring(1);
						if (c.indexOf(name) === 0) return c.substring(name.length, c.length);
					}
					return String.Empty;
				}
			}
		});
		return Cookie;
	})(new Object());
	Object.defineProperty(Utility, "Cookie", {
		configurable: false,
		value: Cookie
	});

	/**
	*	LocalForage utility class
	*/
	var LocalForage = (function (LocalForage) {
		Object.defineProperties(LocalForage, {
			/**
			 * Set an item in local forage if defined, otherwise it falls back to browser cookies
			 */
			"SetItem": {
				configurable: false,
				value: function (name, value, callback) {
					if (typeof localforage !== "undefined" && localforage != null) {
						var callbackFunction = function (err, value) {
							if (typeof callback == "function")
								return callback(err, value);
							else
								return null;
						};
						localforage.setItem(name, value, callbackFunction);
					} else {
						// fallback to cookies
						Utility.Cookie.Set(name, JSON.stringify(value));
						if (typeof callback === "function")
							callback(null, value);
					}
				}
			},
			/**
			 * Clear a local forage item
			 */
			"ClearItem": {
				configurable: false,
				value: function (name) {
					if (typeof localforage !== "undefined" && localforage != null) {
						localforage.setItem(name, String.Empty);
					} else {
						Utility.Cookie.Set(name, String.Empty);
					}
				}
			},
			/**
			 * Get item from local forage if defined, otherwise it falls back to browser cookies
			 */
			"GetItem": {
				configurable: false,
				value: function (name, callback) {
					if (typeof localforage !== "undefined" && localforage != null) {
						var callbackFunction = function (err, value) {
							if (typeof callback == "function")
								return callback(err, value);
							else {
								return null;
							}
						};
						localforage.getItem(name, callbackFunction);

					} else {
						if (typeof callback === "function") {
							var value = Utility.Cookie.Get(name);
							if (value != String.Empty)
								return callback(null, JSON.parse(value));

						}
					}
					return null;
				}
			}
		});
		return LocalForage;
	})(new Object());
	Object.defineProperty(Utility, "LocalForage", {
		value: LocalForage,
		configurable: false
	});

	/**
	*	LocalStorage utility class
	*/
	var LocalStorage = (function (LocalStorage) {
		Object.defineProperties(LocalStorage, {
			/**
			 * Set an item in local storage if defined, otherwise it falls back to browser cookies
			 */
			"SetItemSync": {
				configurable: false,
				value: function (name, object) {
					var key = "afwls/" + name;
					var data = JSON.stringify(object);
					if (typeof localStorage !== "undefined" && localStorage != null) {
						var isQuotaExceeded = function (e) {
							var quotaExceeded = false;
							if (e) {
								if (e.code) {
									switch (e.code) {
										case 22:
											quotaExceeded = true;
											break;
										case 1014:
											// Firefox
											if (e.name === 'NS_ERROR_DOM_QUOTA_REACHED') {
												quotaExceeded = true;
											}
											break;
									}
								} else if (e.number === -2147024882) {
									// Internet Explorer 8
									quotaExceeded = true;
								}
							}
							return quotaExceeded;
						};

						try {
							var result = localStorage.setItem(key, data);
						} catch (e) {
							if (isQuotaExceeded(e)) {
								// TODO: Storage full, maybe notify user or do some clean-up
							}
						}
					} else {
						Utility.Cookie.Set(key, data);
					}
				}
			},

			/**
			 * Get an item in local storage if defined, otherwise it falls back to browser cookies
			 */
			"GetItemSync": {
				configurable: false,
				value: function (name) {
					var key = "afwls/" + name;
					if (typeof localStorage !== "undefined" && localStorage != null) {
						var result = localStorage.getItem(key);
						result = result ? JSON.parse(result) : null;
						return result;
					} else {
						var value = Utility.Cookie.Get(key);
						if (value != String.Empty) {
							return JSON.parse(value);
						}
					}
					return null;
				}
			},

			/**
			 * Set an item in local storage if defined, otherwise it falls back to browser cookies
			 */
			"SetItemAsync": {
				configurable: false,
				value: function (name, object, callback) {
					var key = "afwls/" + name;
					var data = JSON.stringify(object);

					var promise = new Promise(function (resolve, reject) {
						if (typeof localStorage !== "undefined" && localStorage != null) {
							var isQuotaExceeded = function (e) {
								var quotaExceeded = false;
								if (e) {
									if (e.code) {
										switch (e.code) {
											case 22:
												quotaExceeded = true;
												break;
											case 1014:
												// Firefox
												if (e.name === 'NS_ERROR_DOM_QUOTA_REACHED') {
													quotaExceeded = true;
												}
												break;
										}
									} else if (e.number === -2147024882) {
										// Internet Explorer 8
										quotaExceeded = true;
									}
								}
								return quotaExceeded;
							};

							try {
								localStorage.setItem(key, data);
								resolve(object);
							} catch (e) {
								if (isQuotaExceeded(e)) {
									// TODO: Storage full, maybe notify user or do some clean-up
									// probably callback(e, null);
									reject(e);
								}
								else {
									throw e;
								}
							}
						} else {
							Utility.Cookie.Set(key, data);
							resolve(object);
						}
					}).then(function (result) {
						callback(null, result);
					}, function (error) {
						callback(error);
					});

					return promise;
				}
			},

			/**
			 * Get an item in local storage if defined, otherwise it falls back to browser cookies
			 */
			"GetItemAsync": {
				configurable: false,
				value: function (name, callback) {
					var key = "afwls/" + name;
					var promise = new Promise(function (resolve, reject) {
						if (typeof localStorage !== "undefined" && localStorage != null) {
							var result = localStorage.getItem(key);
							result = result ? JSON.parse(result) : null;
							resolve(result);
						} else {
							var result = Utility.Cookie.Get(key);
							if (result != String.Empty) {
								result = JSON.parse(result);
							}
							resolve(result);
						}
					}).then(function (result) {
						callback(null, result);
					}, function (error) {
						callback(error);
					});

					return promise;
				}
			}
		});
		return LocalStorage;
	})(new Object());
	Object.defineProperty(Utility, "LocalStorage", {
		value: LocalStorage,
		configurable: false
	});

	/**
	 * Resources utility class
	 */
	var Resources = (function (Resources) {
		/**
		 * Default dictionary, for resources used in this libray. Overridable by using Utility.Resources.Add(...
		 */
		var dictionary = [];
		dictionary["CookieConsentMessage"] = "Questo sito utilizza cookie tecnici per consentire la fruizione ottimale del sito. Chiudendo questo banner, scorrendo questa pagina o cliccando su qualunque suo elemento consenti all'uso dei cookie";
		dictionary["Error"] = "Errore",
		dictionary["PermissionError"] = "Non possiedi i diritti per effettuare questa operazione",
		dictionary["ErrorMessage"] = "E' avvenuto un errore",
		dictionary["RequestError"] = "E' avvenuto un errore durante l'esecuzione della richiesta",
		dictionary["WeekdaySunday"] = "Domenica",
		dictionary["WeekdayMonday"] = "Luned",
		dictionary["WeekdayTuesday"] = "Marted",
		dictionary["WeekdayWednesday"] = "Mercoled",
		dictionary["WeekdayThursday"] = "Gioved",
		dictionary["WeekdayFriday"] = "Venerd",
		dictionary["WeekdaySaturday"] = "Sabato",
		dictionary["MonthJanuary"] = "Gennaio",
		dictionary["MonthFebruary"] = "Febbraio",
		dictionary["MonthMarch"] = "Marzo",
		dictionary["MonthApril"] = "Aprile",
		dictionary["MonthMay"] = "Maggio",
		dictionary["MonthJune"] = "Giugno",
		dictionary["MonthJuly"] = "Luglio",
		dictionary["MonthAugust"] = "Agosto",
		dictionary["MonthSeptember"] = "Settembre",
		dictionary["MonthOctober"] = "Ottobre",
		dictionary["MonthNovember"] = "Novembre",
		dictionary["MonthDecember"] = "Dicembre",
		dictionary["NotDefinedValue"] = "Il valore non  definito",
		dictionary["NullValue"] = "Il valore  nullo",
		dictionary["NotGreaterOrEqualThan"] = "Il valore non  maggiore o uguale",
		dictionary["NotGreaterThan"] = "Il valore non  maggiore",
		dictionary["NotLessOrEqualThan"] = "Il valore non  minore o uguale",
		dictionary["NotLessThan"] = "Il valore non  minore",
		dictionary["NotValidString"] = "Il valore non rappresenta una stringa valida",
		dictionary["NotValidNumber"] = "Il valore non rappresenta un numero valido",
		dictionary["NotValidDate"] = "Il valore non rappresenta una data valida",
		dictionary["NotValidGuid"] = "Il valore non rappresenta un guid valido",
		dictionary["NotValidBoolean"] = "Il valore non rappresenta un booleano valido",
		dictionary["NotValidFormat"] = "Il valore non rispetta il formato indicato";

		Object.defineProperties(Resources, {
			/**
			 * Get a resource entry from local dictionary if defined, empty string otherwise
			 */
			"Get": {
				configurable: false,
				value: function (key) {
					if (!dictionary) {
						Utility.Console.Warn("No resource dictionary defined yet");
						return String.Empty;
					}
					var value = dictionary[key];
					if (value) {
						return value;
					}
					else {
						Utility.Console.Warn("No dictionary entry for key " + key);
						return String.Empty;
					}
				}
			},
			/**
			 * Add a key/value entry to local dictionary
			 */
			"Add": {
				configurable: false,
				value: function (key, value) {
					if (!dictionary) {
						dictionary = {};
					}
					dictionary[key] = value;
				}
			},
			/**
			* Check if a resource is defined
			*/
			"IsResourceDefined": {
				configurable: false,
				value: function (key) {
					return dictionary[key] != null;
				}
			}

		});
		return Resources;
	})(new Object());
	Object.defineProperty(Utility, "Resources", {
		value: Resources,
		configurable: false
	});

	/**
	*	Session utility class
	*/
	var SessionUser = (function (Session) {
		Object.defineProperties(Session, {
			/**
			 * Set a user session variable on localforage if defined, otherwise it falls back to browser cookies
			 */
			"Set": {
				configurable: false,
				value: function (item, callback) {
					Utility.Cookie.Set(this.UserSessionKey, JSON.stringify(item));
					if (typeof callback === "function")
						callback(item);
				}
			},
			/**
			 * Set a user session variable on localforage if defined, otherwise it falls back to browser cookies
			 */
			"Get": {
				configurable: false,
				value: function () {
					var value = Utility.Cookie.Get(this.UserSessionKey);
					return JSON.parse(value);
				}
			},
			/**
			 * Clear the session variable in local forage
			 */
			"Clear": {
				configurable: false,
				value: function () {
					Utility.Cookie.Set(this.UserSessionKey, "{}");
				}
			},
			/**
			 *
			 */
			"UserSessionKey": {
				configurable: false,
				value: "USER"
			}
		});
		return Session;
	})(new Object());
	Object.defineProperty(Utility, "SessionUser", {
		value: SessionUser,
		configurable: false
	});

	/**
	*	Site utility class
	*/
	var Site = (function (Site) {
		Object.defineProperties(Site, {
			/**
			 * Get the base site path, setted with Utility.Site.SiteInit(... method
			 */
			"GetSitePath": {
				configurable: false,
				value: function () {
					if (this.sitePath != null) {
						return this.sitePath;
					}
					else {
						return String.Empty;
					}
				}
			},
			/**
			 * Method to set site base url and boolean for debug configuration
			 */
			"SiteInit": {
				configurable: false,
				value: function (baseurl, isDebug, ajaxInit) {
					if (!baseurl.IsNullOrEmpty()) {
						this.sitePath = baseurl;
					} else {
						Utility.Console.Error("Site was initiated with null site path");
					}

					Utility.Console.IsDebug = isDebug;
					Utility.Console.SetConsoleLevel(isDebug ? LogLevel.Info : LogLevel.Error);
					if ($) {
						var staticOptions;
						$.ajaxPrefilter(function (options) {
							if (typeof options.hideModal != "boolean") {
								options.hideModal = false;
							}
							staticOptions = options;
							options.global = true;
							var label;
							if (staticOptions != null) {
								if (typeof staticOptions.hideModal === "boolean" && !staticOptions.hideModal && staticOptions.url.indexOf("document-viewer") < 0 && staticOptions.url.indexOf("GetCardFilterRegistryTag") < 0) {
									if (staticOptions.label != null) {
										label = staticOptions.label;
									}
									else if (typeof staticOptions.operationType == "string") {
										switch (staticOptions.operationType) {
											case AjaxOperationType.Loading:
												label = Utility.Resources.Get("Loading");
												break;
										}
									}
									Utility.Loading.ShowWaiting(label);
								}
							}
						});
						if (!ajaxInit) {
							$(window).ajaxStart(function () {

							});
							$(window).ajaxStop(function () {
								Utility.Loading.HideWaiting();
							});
						}
					};
				}
			}
		});

		return Site;
	})(new Object());
	Object.defineProperty(Utility, "Site", {
		value: Site,
		configurable: false
	});

	return Utility;
})(new Object());


/**
*	Cookie consent options
*/
var CookieConsentOptions = (function () {
	function CookieConsentOptions(message) {
		Object.defineProperty(this, "markup", {
			configurable: false,
			value:
				'<div class="cc_banner-wrapper {{containerClasses}}">' +
				"<div class=\"cc_banner cc_container cc_container--open\">" +
				"<a data-cc-event=\"click:SetDismissConsentCookie\" class=\"cc_btn cc_btn_accept_all\">{{options.dismiss}}</a>" +
				"<p class=\"cc_message\">{{options.message}} <a data-cc-if=\"options.Link\" class=\"cc_more_info\" href=\"{{options.Link || \"\"}}\">{{options.learnMore}}</a></p>" +
				"</div>" +
				"</div>"

		});
		Object.defineProperty(this, "message", {
			configurable: false,
			value: message || Utility.Resources.Get("CookieConsentMessage")
		});
	}

	Object.defineProperty(CookieConsentOptions.prototype, "message", {
		get: function () {
			return this._message;
		},
		set: function (value) {
			this._message = value;
		},
		enumerable: true,
		configurable: true
	});
	Object.defineProperty(CookieConsentOptions.prototype, "dismiss", {
		get: function () {
			return this._dismiss;
		},
		set: function (value) {
			this._dismiss = value;
		},
		enumerable: true,
		configurable: true
	});
	Object.defineProperty(CookieConsentOptions.prototype, "learnMore", {
		get: function () {
			return this._learnMore;
		},
		set: function (value) {
			this._learnMore = value;
		},
		enumerable: true,
		configurable: true
	});
	Object.defineProperty(CookieConsentOptions.prototype, "link", {
		get: function () {
			return this._link;
		},
		set: function (value) {
			this._link = value;
		},
		enumerable: true,
		configurable: true
	});
	Object.defineProperty(CookieConsentOptions.prototype, "containerSelector", {
		get: function () {
			return this._containerSelector;
		},
		set: function (value) {
			this._containerSelector = value;
		},
		enumerable: true,
		configurable: true
	});
	Object.defineProperty(CookieConsentOptions.prototype, "container", {
		get: function () {
			return this._container;
		},
		set: function (value) {
			this._container = value;
		},
		enumerable: true,
		configurable: true
	});
	Object.defineProperty(CookieConsentOptions.prototype, "markup", {
		get: function () {
			return this._markup;
		},
		set: function (value) {
			this._markup = value;
		},
		enumerable: true,
		configurable: true
	});
	Object.seal(CookieConsentOptions);
	return CookieConsentOptions;
})();

/**
*	Guid helper type
*/
var Guid = (function () {
	function Guid(value) {
		if (value != null) {
			if (Guid.IsValidGuid(value))
				this._value = value;
			this.toString = function () {
				return value;
			}
		}
		else {
			this._value = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {
				var r = Math.random() * 16 | 0, v = c === 'x' ? r : (r & 0x3 | 0x8);
				return v.toString(16);
			});
		}
	}
	Guid.prototype.toString = function () {
		return this._value;
	};

	Guid.EmptyGuid = function () {
		return new Guid(this._emptyGuid);
	};
	Guid.IsValidGuid = function (guid) {
		return !guid.IsNullOrEmpty() && guid !== "00000000-0000-0000-0000-000000000000" && /^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/.test(guid);
	};
	Guid._emptyGuid = "00000000-0000-0000-0000-000000000000";
	Object.seal(Guid);
	return Guid;
})();

/**
*	EventBind object
*/
var EventBind = function EventBind(eventName, eventFunction) {
	var obj = {};
	Object.defineProperties(obj, {
		"EventName": {
			value: eventName,
			configurable: false
		},
		"EventFunction": {
			value: eventFunction,
			configurable: false
		}
	});
	Object.preventExtensions(obj);
	return obj;
}

/**
 * Language enum
 */
var Language = (function () {
	var obj = {};
	Object.defineProperties(obj, {
		"Unknown": {
			configurable: false,
			value: 0
		},
		"Italian": {
			configurable: false,
			value: 1
		},
		"English": {
			configurable: false,
			value: 2
		},
		"French": {
			configurable: false,
			value: 3
		},
		"German": {
			configurable: false,
			value: 4
		},
		"Spanish": {
			configurable: false,
			value: 5
		},
		"Portuguese": {
			configurable: false,
			value: 6
		},
		"Romanian": {
			configurable: false,
			value: 7
		},
		"Brazilian": {
			configurable: false,
			value: 8
		}
	});
	return obj;
})();

/**
 * Session info object
 */
var SessionInfo = (function () {
	function SessionInfo() {
	}
	Object.defineProperty(SessionInfo.prototype, "ClientType", {
		get: function () {
			return this._clientType;
		},
		enumerable: true,
		configurable: true
	});
	Object.defineProperty(SessionInfo.prototype, "UserId", {
		get: function () {
			return this._userId;
		},
		set: function (value) {
			this._userId = value;
		},
		enumerable: true,
		configurable: true
	});
	Object.seal(SessionInfo);
	return SessionInfo;
})();

/**
 * Validator object
 */
var Validator = (function () {
	function Validator(rules, stopAtFirst) {
		if (rules == null) {
			rules = new Array();
		}
		this.Rules = rules;
		this.StopAtFirstError = (stopAtFirst != null) ? stopAtFirst : false;
	}
	Object.seal(Validator);
	return Validator;
})();

/**
 * Report message object
 */
var ReportMessage = (function () {
	function ReportMessage(fieldName) {
		this.FieldName = fieldName;
	}
	Object.seal(ReportMessage);
	return ReportMessage;
})();

/**
 * Validator rule object
 * @param {} rule one of Rules enum values
 * @param {} fieldName The object field name to be checked
 * @param {} pattern The regular expression to use to check the object
 * @param {} objType One of types enum value
 * @param {} refValue ref value, if needed by rule
 */
var ValidatorRule = function ValidatorRule(rule, fieldName, pattern, objType, refValue) {
	var obj = {};
	Object.defineProperties(obj, {
		"Rule": {
			configurable: false,
			value: rule
		},
		"FieldName": {
			configurable: false,
			value: fieldName
		},
		"Pattern": {
			configurable: false,
			value: pattern
		},
		"Type": {
			configurable: false,
			value: objType
		},
		"RefValue": {
			configurable: false,
			value: refValue
		}
	});
	Object.preventExtensions(obj);
	return obj;
};

/**
 * Rules enum
 */
var Rules = (function (Rules) {
	Object.defineProperties(Rules, {
		"NotNull": {
			configurable: false,
			value: 0
		},
		"GreaterThan": {
			configurable: false,
			value: 1
		},
		"LessThan": {
			configurable: false,
			value: 2
		},
		"GreaterOrEqualThan": {
			configurable: false,
			value: 3
		},
		"LessOrEqualThan": {
			configurable: false,
			value: 4
		}
	});
	Object.preventExtensions(Rules);
	return Rules;
})(new Object());

/**
 * Types enum for validation rules definition
 */
var Types = (function (Types) {
	Object.defineProperties(Types, {
		"String": {
			configurable: false,
			value: 0
		},
		"Number": {
			configurable: false,
			value: 1
		},
		"Date": {
			configurable: false,
			value: 2
		},
		"Guid": {
			configurable: false,
			value: 3
		},
		"Boolean": {
			configurable: false,
			value: 4
		}
	});

	Object.preventExtensions(Types);
	return Types;
})(new Object());

/**
 * Enum for ajax loading
 * @param obj
 */
var AjaxOperationType = (function (Operations) {
	Object.defineProperties(Operations, {
		"Default": {
			configurable: false,
			value: "DEFAULT"
		},
		"Loading": {
			configurable: false,
			value: "LOADING"
		}
	});
	Object.preventExtensions(Operations);
	return Operations;
})(new Object());

/**
 * Ajax paramethers object
 */
var AjaxParamethers = (function () {
	/**
	 * Ajax paramethers constructor. 
	 * @param {} uri The address for ajax call. Can be a relative path (if SitePath has been defined) or an absolute path;
	 * @param {} data the data to be sent to server
	 */
	function AjaxParamethers(uri, data, hideModal, text) {
		if (/(http|https)/.exec(uri)) {
			this.url = uri;
		}
		else {
			this.url = Utility.Site.GetSitePath() + uri;
		}
		this.data = data;
		this.cache = false;
		this.async = true;
		this.dataType = "json";
		this.traditional = true;
		this.crossDomain = false;
		this.label = text;

		this.operationType = AjaxOperationType.Default;
		if (typeof hideModal == "boolean") {
			this.hideModal = hideModal;
		} else {
			this.hideModal = false;
		}
	}
	/**
	 * Callback for ajax jsonp call
	 */
	Object.defineProperty(AjaxParamethers.prototype, "JsonPCallback", {
		get: function () {
			return this.jsonpCallback;
		},
		set: function (value) {
			this.jsonpCallback = value;
		},
		enumerable: true
	});
	/**
	 * Headers for ajax call
	 */
	Object.defineProperty(AjaxParamethers.prototype, "Headers", {
		get: function () {
			return this.headers;
		},
		set: function (value) {
			this.headers = value;
		},
		enumerable: true
	});
	/**
	 * Content type for ajax call
	 */
	Object.defineProperty(AjaxParamethers.prototype, "ContentType", {
		get: function () {
			return this.contentType;
		},
		set: function (value) {
			this.contentType = value;
		},
		enumerable: true
	});
	/**
	 * Data to be sent with ajax call
	 */
	Object.defineProperty(AjaxParamethers.prototype, "Data", {
		get: function () {
			return this.data;
		},
		set: function (value) {
			this.data = value;
		},
		enumerable: true
	});
	/**
	 * Request ajax url
	 */
	Object.defineProperty(AjaxParamethers.prototype, "Url", {
		get: function () {
			return this.url;
		},
		set: function (value) {
			this.url = value;
		},
		enumerable: true
	});
	/**
	 * Boolean for caching the ajax calls
	 */
	Object.defineProperty(AjaxParamethers.prototype, "Cache", {
		get: function () {
			return this.cache;
		},
		set: function (value) {
			this.cache = value;
		},
		enumerable: true
	});
	/**
	 * Boolean for async ajax call
	 */
	Object.defineProperty(AjaxParamethers.prototype, "Async", {
		get: function () {
			return this.async;
		},
		set: function (value) {
			this.async = value;
		},
		enumerable: true
	});
	/**
	 * Boolean for traditional call
	 */
	Object.defineProperty(AjaxParamethers.prototype, "Traditional", {
		get: function () {
			return this.traditional;
		},
		set: function (value) {
			this.traditional = value;
		},
		enumerable: true
	});
	/**
	 * Boolean for cross domain call
	 */
	Object.defineProperty(AjaxParamethers.prototype, "CrossDomain", {
		get: function () {
			return this.crossDomain;
		},
		set: function (value) {
			this.crossDomain = value;
		},
		enumerable: true
	});
	/**
	 * Data type for ajax call
	 */
	Object.defineProperty(AjaxParamethers.prototype, "DataType", {
		get: function () {
			return this.dataType;
		},
		set: function (value) {
			this.dataType = value;
		},
		enumerable: true
	});
	return AjaxParamethers;
})();

/**
 * Extend native type String
 */
Object.defineProperties(String.prototype, {
	"IsNullOrEmpty": {
		configurable: false,
		value: function () {
			return this.toString() === null || this.toString() === String.Empty;
		}
	},
	"Contains": {
		configurable: false,
		value: function (regEx) {
			if (typeof (this.toString()) != "string") {
				throw "Input variable must be string";
			}
			if (!regEx) {
				return undefined;
			}
			return regEx.test(this.toString());
		}
	},
	"ClearStartingSpaces": {
		configurable: false,
		value: function () {
			return /^(\s*)\S.+$/.test(this.toString()) ? this.toString().replace(RegExp.$1, String.Empty) : this.toString();
		}
	},
	"ClearEndingSpaces": {
		configurable: false,
		value: function () {
			return /.+\S(\s*)$/.test(this.toString()) ? this.toString().replace(RegExp.$1, String.Empty) : this.toString();
		}
	},
	"ClearBoundingSpaces": {
		configurable: false,
		value: function () {
			return this.toString().ClearEndingSpaces.ClearStartingSpaces();
		}
	},
	"ClearAllSpaces": {
		configurable: false,
		value: function () {
			return this.toString().replace(/ /g, String.Empty);
		}
	},
	"EndsWith": {
		configurable: false,
		value: function (suffix) {
			return this.toString().indexOf(suffix, this.toString().length - suffix.length) !== -1;
		}
	},
	"StartsWith": {
		configurable: false,
		value: function (prefix) {
			return this.toString().slice(0, prefix.length) === prefix;
		}
	},
	"ToBoolean": {
		configurable: false,
		value: function () {
			switch (this.toLowerCase().trim()) {
				case "true": case "yes": case "1": return true;
				case "false": case "no": case "0": case null: return false;
				default: return Boolean(this);
			}
		}
	},
	"EscapeQuot": {
		configurable: false,
		value: function () {
			var stringa;
			stringa = this.replace(/'/g, "\\\'");
			return stringa;
		}
	},
	"PurgeDangerChar": {
		configurable: false,
		value: function() {
			var stringa;
			stringa = this.replace(/[^\w\s]/gi, '');
			return stringa;
		}
	}
});

String.Empty = '';
String.IsNullOrEmpty = function (value) {
	return value == null || value === String.Empty;
}


/**
 * Extend native type Array
 */
Object.defineProperties(Array.prototype, {
	"Move": {
		configurable: false,
		value: function (fromIndex, toIndex) {
			if (toIndex >= this.length) {
				var k = toIndex - this.length;
				while ((k--) + 1) {
					this.push(undefined);
				}
			}
			var obj = this.splice(fromIndex, 1)[0];
			this.splice(toIndex, 0, obj);
			return this; // for chaining purposes
		}
	},
	"RemoveAt": {
		configurable: false,
		value: function (index) {
			this.splice(index, 1);
			return this; // for chaining purposes
		}
	},
	"InsertAt": {
		configurable: false,
		value: function (index, item) {
			this.splice(index, 0, item);
			return this; // for chaining purposes
		}
	}
});

var blurredElements = "#page-container, header, footer,.k-pager-wrap";